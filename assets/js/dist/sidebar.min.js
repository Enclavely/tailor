!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function g(a){return a&&_.contains(_.keys(e.stylesheets),a)||(a="all"),a}function j(a,b,c){"function"==typeof c&&(f[a][b]=f[a][b]||[],f[a][b].push(c))}var e,d=window.app,f={sidebar:[],element:[]},h=function(a){var b=a.get("id");_.isEmpty(f.sidebar[b])||_.each(f.sidebar[b],function(b){b.apply(window,[a.get("value"),a.previous("value")])})},i=function(a,b){var c=b.model.get("id"),d=a.get("id");if(f.element.hasOwnProperty(d)&&0!=f.element[d].length){1==f.element[d].length&&e.deleteRules(c,d);var i,h={};_.each(f.element[d],function(f){if("function"==typeof f&&(i=f.apply(b,[a.get("value"),a.previous("value"),b.model]),_.isArray(i)&&i.length>0)){for(var j in i)if(i.hasOwnProperty(j)){if(!i[j].hasOwnProperty("selectors")||!i[j].hasOwnProperty("declarations"))continue;var k=g(i[j].media);h[k]=h[k]||{},h[k][c]=h[k][c]||[],_.keys(i[j].declarations).length>0&&h[k][c].push({selectors:i[j].selectors,declarations:i[j].declarations,setting:d})}e.addRules(h)}})}};d.listenTo(d.channel,"sidebar:setting:change",h),d.listenTo(d.channel,"element:setting:change",i),d.channel.on("module:css:stylesheets:ready",function(a){e=a}),b.exports={onChange:function(a,b){var c=a.split(":");c.length>=2&&_.contains(["sidebar","element"],c[0])&&j(c[0],c[1],b)}}},{}],2:[function(a,b,c){var d=Marionette.Behavior.extend({events:{dragstart:"onDragStart",dragend:"onDragEnd",drag:"onDrag"},onDragStart:function(a){app.channel.trigger("canvas:dragstart",a.originalEvent,this.view)},onDrag:function(a){app.channel.trigger("canvas:drag",a.originalEvent,this.view)},onDragEnd:function(a){app.channel.trigger("canvas:dragend",a.originalEvent,this.view)}});b.exports=d},{}],3:[function(a,b,c){var e,d=jQuery;e={url:window.ajaxurl,post:function(a,b){return ajax.send({data:_.isObject(a)?a:_.extend(b||{},{action:a})})},send:function(a,b){return _.isObject(a)?b=a:(b=b||{},b.data=_.extend(b.data||{},{action:a,tailor:1})),b=_.defaults(b||{},{type:"POST",url:ajax.url,context:this}),d.Deferred(function(a){b.success&&a.done(b.success);var c=b.error?b.error:ajax.onError;a.fail(c),delete b.success,delete b.error,d.ajax(b).done(function(b){"1"!==b&&1!==b||(b={success:!0}),_.isObject(b)&&!_.isUndefined(b.success)?a[b.success?"resolveWith":"rejectWith"](this,[b.data]):a.rejectWith(this,[b])}).fail(function(){a.rejectWith(this,arguments)})}).promise()},onError:function(a){return Tailor.Notify?void(a&&a.hasOwnProperty("message")?Tailor.Notify(a.message):"0"==a?Tailor.Notify(window._l10n.expired):"-1"==a?Tailor.Notify(window._l10n.invalid):Tailor.Notify(window._l10n.error)):void console.error(a)}},window.ajax=e,b.exports=e},{}],4:[function(a,b,c){var d;a("./polyfills/transitions"),d=function(a){this.options=_.extend({},this.defaults,a),this.el=document.createElement("div"),this.el.className="notification notification--"+this.options.type,this.container=document.getElementById("tailor-notification-container")||document.body,this.initialize()},d.prototype={defaults:{message:"",type:"",ttl:3e3,onShow:function(){},onHide:function(){}},initialize:function(){this.el.innerHTML=this.options.message,this.container.insertBefore(this.el,this.container.firstChild)},show:function(){var a=this;a.el.classList.add("is-visible"),"function"==typeof a.options.onShow&&a.options.onShow.call(a),a.session=setTimeout(function(){a.hide()},a.options.ttl)},hide:function(){var a=this,b=function(c){if(Modernizr.cssanimations){if(c.target!==a.el)return!1;a.el.removeEventListener(window.transitionEndName,b)}a.container.removeChild(a.el),"function"==typeof a.options.onShow&&a.options.onShow.call(a)};clearTimeout(a.session),Modernizr.csstransitions?(a.el.addEventListener(window.transitionEndName,b),a.el.classList.remove("is-visible")):b()}};var e=function(a,b){var c=new d({message:a,type:b||"error"});c.show()};b.exports=e},{"./polyfills/transitions":7}],5:[function(a,b,c){!function(){function e(a){this.el=a;for(var c=a.className.replace(/^\s+|\s+$/g,"").split(/\s+/),d=0;d<c.length;d++)b.call(this,c[d])}function f(a,b,c){Object.defineProperty?Object.defineProperty(a,b,{get:c}):a.__defineGetter__(b,c)}if(!("undefined"==typeof window.Element||"classList"in document.documentElement)){var a=Array.prototype,b=a.push,c=a.splice,d=a.join;e.prototype={add:function(a){this.contains(a)||(b.call(this,a),this.el.className=this.toString())},contains:function(a){return this.el.className.indexOf(a)!=-1},item:function(a){return this[a]||null},remove:function(a){if(this.contains(a)){for(var b=0;b<this.length&&this[b]!=a;b++);c.call(this,b,1),this.el.className=this.toString()}},toString:function(){return d.call(this," ")},toggle:function(a){return this.contains(a)?this.remove(a):this.add(a),this.contains(a)}},window.DOMTokenList=e,f(Element.prototype,"classList",function(){return new e(this)})}}()},{}],6:[function(a,b,c){!function(a){"use strict";for(var b=0,c=["ms","moz","webkit","o"],d=0;d<c.length&&!a.requestAnimationFrame;++d)a.requestAnimationFrame=a[c[d]+"RequestAnimationFrame"],a.cancelAnimationFrame=a[c[d]+"CancelAnimationFrame"]||a[c[d]+"CancelRequestAnimationFrame"];a.requestAnimationFrame||(a.requestAnimationFrame=function(c,d){var e=(new Date).getTime(),f=Math.max(0,16-(e-b)),g=a.setTimeout(function(){c(e+f)},f);return b=e+f,g}),a.cancelAnimationFrame||(a.cancelAnimationFrame=function(a){clearTimeout(a)})}(window)},{}],7:[function(a,b,c){!function(a){"use strict";function c(){var a,c={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(a in c)if(c.hasOwnProperty(a)&&"undefined"!=typeof b.style[a])return c[a];return!1}function d(){var a,c={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(a in c)if(c.hasOwnProperty(a)&&"undefined"!=typeof b.style[a])return c[a];return!1}var b=document.createElement("fakeelement");a.animationEndName=c(),a.transitionEndName=d()}(window)},{}],8:[function(a,b,c){var f,d=Backbone.$,e=d(document);f=Marionette.Application.extend({el:document.querySelector("#tailor"),initialize:function(){this._collapsed=!1,this._unsavedChanges=!1,this.saveButton=document.querySelector("#tailor-save"),this.allowableEvents=["canvas:initialize","element:add","element:move","element:resize","element:change:order","element:copy","element:delete","elements:restore","template:add","history:undo","history:redo","modal:open","modal:destroy"],this.addEventListeners()},hasUnsavedChanges:function(){return this._unsavedChanges},addEventListeners:function(){var a=this,b=["element:add","element:move","element:resize","element:change:order","element:copy","element:delete","modal:apply","template:add","sidebar:setting:change"];a.listenTo(a.channel,b.join(" "),function(){a.saveButton.disabled=!1,a.saveButton.innerHTML=window._l10n.publish,a._unsavedChanges=!0}),d("#tailor-collapse").on("click",function(){a._collapsed=!a._collapsed,a.el.classList.toggle("is-collapsed",a._collapsed),a.saveButton.setAttribute("aria-expanded",!a._collapsed),a.triggerMethod("collapse:sidebar")}),d(a.saveButton).on("click",function(){a.el.classList.add("is-saving"),a.saveButton.setAttribute("disabled",!0);var b=a.channel.request("canvas:elements"),c=a.channel.request("sidebar:settings");window.ajax.send("tailor_save",{data:{post_id:window.post.id,models:JSON.stringify(b.toJSON()),settings:JSON.stringify(c.toJSON()),nonce:window._nonces.save},success:function(){a.saveButton.disabled=!0,a.saveButton.innerHTML=window._l10n.saved,a._unsavedChanges=!1,a.channel.trigger("sidebar:save")},error:function(b){a.saveButton.disabled=!1,b&&b.hasOwnProperty("message")?Tailor.Notify(b.message):"0"==b?Tailor.Notify(window._l10n.expired):"-1"==b?Tailor.Notify(window._l10n.invalid):Tailor.Notify(window._l10n.error)},complete:function(){a.el.classList.remove("is-saving")}})}),a.listenToOnce(a.channel,"canvas:handshake",a.registerRemoteChannel),e.on("keydown",function(b){b.ctrlKey&&89==b.keyCode&&(_.contains(["INPUT","SELECT","TEXTAREA"],b.target.tagName)||a.channel.trigger("history:redo"))}),e.on("keydown",function(b){b.ctrlKey&&90==b.keyCode&&(_.contains(["INPUT","SELECT","TEXTAREA"],b.target.tagName)||a.channel.trigger("history:undo"))})},registerRemoteChannel:function(){var a=this,b=this.el.querySelector("#tailor-sidebar-preview");if(window.location.origin===b.contentWindow.location.origin){var c=b.contentWindow.app.channel;app.channel.reply("canvas:elements",function(a){return c.request("canvas:elements",a)}),app.channel.reply("canvas:element:selected",function(){return c.request("canvas:element:selected")}),app.listenTo(c,"all",a.forwardRemoteEvent),app.el.classList.add("is-initialized"),app.el.querySelector(".tailor-preview__viewport").classList.add("is-loaded")}},forwardRemoteEvent:function(a){_.contains(this.allowableEvents,a)&&this.channel.trigger.apply(this.channel,arguments)},maybeCollapse:function(a){13===a.keyCode&&this.onCollapse()},maybeSave:function(a){13===a.keyCode&&this.onSave()}}),b.exports=f},{}],9:[function(a,b,c){var d=Marionette.Behavior.extend({ui:{backButton:".back-button",helpButton:".help-button",helpDescription:".help-description",searchBar:".search"},events:{"click @ui.helpButton":"toggleHelp","change @ui.searchBar":"doSearch","input @ui.searchBar":"doSearch","keyup @ui.searchBar":"doSearch","search @ui.searchBar":"doSearch"},triggers:{"click @ui.backButton":"back"},toggleHelp:function(){this.ui.helpButton.toggleClass("is-open"),this.ui.helpDescription.slideToggle(150)},doSearch:function(a){this.view.collection.doSearch(a.target.value)}});b.exports=d},{}],10:[function(a,b,c){var d=Marionette.Behavior.extend({ui:{handle:".modal__title"},events:{mousemove:"onMouseMove",mousedown:"onMouseDown","dblclick @ui.handle":"toggleFullScreen"},initialize:function(){this._isResizing=!1,this._isResizing=!1,this.$ghostPane=jQuery('<div class="ghost-pane"></div>').appendTo("body"),this.addEventListeners()},addEventListeners:function(){var a=this;window.addEventListener("resize",function(){a.checkPosition()},!1)},detectEdges:function(a){var b=this.el.getBoundingClientRect(),c=a.clientX-b.left,d=a.clientY-b.top,e=8,f=[];return d<e&&f.push("top"),d>=b.height-e&&f.push("bottom"),c<e&&f.push("left"),c>=b.width-e&&f.push("right"),f},onMouseMove:function(a){if(!this._isResizing&&!this._isDragging){this.$el.removeClass("top top-left top-right left right bottom bottom-left bottom-right is-draggable");var b=this.detectEdges(a);!b.length||this.container.classList.contains("is-full-screen")||document.body.classList.contains("mce-fullscreen")?a.target.classList.contains("modal__title")&&this.el.classList.add("is-draggable"):this.$el.addClass(b.join("-"))}},onMouseDown:function(a){if(!this._isResizing&&!this._isDragging){var b=this.detectEdges(a);!b.length||this.$container.hasClass("is-full-screen")||document.body.classList.contains("mce-fullscreen")?a.target===this.ui.handle.get(0)&&this.drag(a):this.resize(a,b)}},resize:function(a,b){function j(a){var b=e*(a.pageX-f),j=e*(a.pageY-g);switch(d){case"top":i+=j,i>400&&(c.container.style.height=i+"px",c.container.style.top=parseInt(c.container.style.top,10)-j+"px");break;case"bottom":i+=j,i>400&&(c.container.style.height=i+"px");break;case"left":h+=b,h>300&&(c.container.style.width=h+"px",c.container.style.left=parseInt(c.container.style.left,10)-b+"px");break;case"right":h+=b,h>300&&(c.container.style.width=h+"px");break;case"top-left":i+=j,h+=b,h>300&&(c.container.style.width=h+"px",c.container.style.left=parseInt(c.container.style.left,10)-b+"px"),i>400&&(c.container.style.height=i+"px",c.container.style.top=parseInt(c.container.style.top,10)-j+"px");break;case"top-right":i+=j,h-=b,h>300&&(c.container.style.width=h+"px"),i>400&&(c.container.style.height=i+"px",c.container.style.top=parseInt(c.container.style.top,10)-j+"px");break;case"bottom-left":i-=j,h+=b,h>300&&(c.container.style.width=h+"px",c.container.style.left=parseInt(c.container.style.left,10)-b+"px"),i>400&&(c.container.style.height=i+"px");break;case"bottom-right":i+=j,h+=b,h>300&&(c.container.style.width=h+"px"),i>400&&(c.container.style.height=i+"px")}c.triggerResize(h,i),g=a.pageY,f=a.pageX}function k(a){c._isResizing=!1,document.body.classList.remove("is-dragging"),document.removeEventListener("mousemove",j,!1),document.removeEventListener("mouseup",k,!1),c.checkPosition(150)}var c=this,d=b.join("-"),e=_.contains(b,"top")||_.contains(b,"left")?-1:1;this._isResizing=!0,document.body.classList.add("is-dragging"),document.addEventListener("mousemove",j,!1),document.addEventListener("mouseup",k,!1);var f=a.pageX,g=a.pageY,h=parseInt(c.container.style.width,10),i=parseInt(c.container.style.height,10)},drag:function(a){function e(a){document.body.classList.add("is-dragging"),b.container.style.top=parseInt(b.container.style.top,10)+(a.pageY-d)+"px",b.container.style.left=parseInt(b.container.style.left,10)+(a.pageX-c)+"px",a.pageX<5?b.$ghostPane.css({display:"block"}).addClass("left"):a.pageX>window.innerWidth-5?b.$ghostPane.css({display:"block"}).addClass("right"):a.pageY<5?b.$ghostPane.css({display:"block"}).addClass("top"):(b.resetGhostPane(),b.container.classList.contains("is-full-screen")&&(b.$container.removeClass("is-full-screen is-full-screen-left is-full-screen-right"),b.container.style.top=a.pageY-20+"px",b.container.style.left=a.pageX-parseInt(b.container.style.width,10)/2+"px",b.triggerResize(parseInt(b.container.style.width,10),parseInt(b.container.style.height,10)))),c=a.pageX,d=a.pageY}function f(a){b._isDragging=!1,document.body.classList.remove("is-dragging"),document.removeEventListener("mousemove",e,!1),document.removeEventListener("mouseup",f,!1),b.maybeToggleFullScreen(a)}var c,d,b=this;this._isDragging=!0,document.addEventListener("mousemove",e,!1),document.addEventListener("mouseup",f,!1)},maybeToggleFullScreen:function(a){var b;a.pageY<5?b="top":a.pageX<5?b="left":a.pageX>window.innerWidth-5&&(b="right"),b?this.enterFullScreen(b):this.checkPosition(150)},toggleFullScreen:function(){this.container.classList.contains("is-full-screen")?this.exitFullScreen():this.enterFullScreen("top")},enterFullScreen:function(a){this.$container.removeClass("is-full-screen is-full-screen-left is-full-screen-right"),this.container.classList.add("is-full-screen"),this.container.classList.add("is-full-screen-"+a);var b=this.container.getBoundingClientRect();this.triggerResize(b.width,b.height)},exitFullScreen:function(){this.$container.removeClass("is-full-screen is-full-screen-left is-full-screen-right"),this.triggerResize(parseInt(this.container.style.width,10),parseInt(this.container.style.height,10)),this.checkPosition(150),this.resetGhostPane()},triggerResize:function(a,b){this.view.trigger("modal:resize",a,b)},resetGhostPane:function(){this.$ghostPane.css({display:"none"}),this.$ghostPane[0].className="ghost-pane"},onShow:function(){this.container=this.el.parentNode,this.$container=this.$el.parent(),this.checkPosition()},checkPosition:function(a){a=a||0;var b=parseInt(this.container.style.width,10),c=parseInt(this.container.style.height,10),d=parseInt(this.container.style.top,10),e=parseInt(this.container.style.left,10),f={};d<window.scrollY?f.top=window.scrollY:d+c>window.scrollY+window.innerHeight&&(f.top=Math.max(window.scrollY+window.innerHeight-c,window.scrollY)),e<0?f.left=window.scrollX:e+b>window.scrollX+window.innerWidth&&(f.left=Math.max(window.scrollX+window.innerWidth-b,window.scrollX)),a?this.$container.animate(f,a):this.$container.css(f)},onDestroy:function(){this.$ghostPane.remove()}});b.exports=d},{}],11:[function(a,b,c){var d=Marionette.ItemView.extend({tagName:"li",className:function(){return"control control--"+this.model.get("type")},events:{"input @ui.input":"onControlChange","change @ui.input":"onControlChange","click @ui.default":"restoreDefaultValue"},getTemplate:function(){return"#tmpl-tailor-control-"+this.model.get("type")},serializeData:function(){var a=Backbone.Marionette.ItemView.prototype.serializeData.apply(this,arguments),b=this.getDefaultValue();return a.value=this.getSettingValue(),a.showDefault=null!=b&&a.value!=b,a},initialize:function(){this.addEventListeners(),this.checkDependencies(this.model.setting)},addEventListeners:function(){this.listenTo(this.model.setting,"change",this.toggleDefaultButton),this.listenTo(this.model.setting.collection,"change",this.checkDependencies)},checkDependencies:function(a){var b=this.model.get("dependencies"),c=a.collection,d=!0;for(var e in b)if(b.hasOwnProperty(e)){var f=c.get(e);if(!f)continue;var g=b[e].condition,h=f.get("value"),i=b[e].value;if(!Tailor.Helpers.checkCondition(g,h,i)){d=!1;break}}this.$el.toggle(d)},onControlChange:function(a){"function"==typeof this.ui.input.val&&this.setSettingValue(this.ui.input.val())},toggleDefaultButton:function(){var a=this.getDefaultValue();this.ui.default.toggleClass("is-hidden",null==a||this.getSettingValue()==a)},getSettingValue:function(){return this.model.setting.get("value")},setSettingValue:function(a){this.model.setting.set("value",a)},getDefaultValue:function(){return this.model.setting.get("default")},restoreDefaultValue:function(a){this.setSettingValue(this.getDefaultValue()),this.triggerMethod("restore:default")}});b.exports=d},{}],12:[function(a,b,c){var e,d=a("./abstract-control");e=d.extend({ui:{input:"button",default:".js-default"},events:{"click @ui.input":"onControlChange","click @ui.default":"restoreDefaultValue"},templateHelpers:{active:function(a){return a===this.value?"active":""}},addEventListeners:function(){this.listenTo(this.model.setting,"change",this.render),this.listenTo(this.model.setting.collection,"change",this.checkDependencies)},onControlChange:function(a){var b=a.currentTarget;this.ui.input.removeClass("active"),b.classList.add("active"),this.setSettingValue(b.value)}}),b.exports=e},{"./abstract-control":11}],13:[function(a,b,c){var e,d=a("./abstract-control");e=d.extend({ui:{input:"input",default:".js-default"},templateHelpers:{checked:function(a){var b=this.value.split(",");return-1!==b.indexOf(a)?"checked":""}},addEventListeners:function(){this.listenTo(this.model.setting,"change",this.render),this.listenTo(this.model.setting.collection,"change",this.checkDependencies)},onControlChange:function(a){var b=[];_.each(this.ui.input,function(a){a.checked&&b.push(a.value)}),this.setSettingValue(b.join(","))}}),b.exports=e},{"./abstract-control":11}],14:[function(a,b,c){var e,d=a("./abstract-control");e=d.extend({ui:{input:"textarea",default:".js-default"},events:{"click @ui.default":"restoreDefaultValue"},serializeData:function(){var a=Backbone.Marionette.ItemView.prototype.serializeData.apply(this,arguments),b=this.getDefaultValue();return a.value=this.getSettingValue(),a.showDefault=null!=b&&a.value!=b,a.cid=this.cid,a},onRender:function(){var a=this,b=this.model.get("mode");a.editor=CodeMirror.fromTextArea(this.ui.input.get(0),{mode:b,lineNumbers:!0,matchBrackets:!0,continueComments:"Enter",viewportMargin:1/0,extraKeys:{F11:function(a){a.setOption("fullScreen",!a.getOption("fullScreen"))},Esc:function(a){a.getOption("fullScreen")&&a.setOption("fullScreen",!1)}}});var c=function(b){a.setSettingValue(b.getValue())};this.editor.on("change",c)},restoreDefaultValue:function(a){var b=this.getDefaultValue();this.setSettingValue(b),this.editor.setValue(b)},onDestroy:function(){this.editor.off("change",this.onChange),this.editor.toTextArea()}}),b.exports=e},{"./abstract-control":11}],15:[function(a,b,c){var e,d=a("./abstract-control");!function(a){var b="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAAHnlligAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHJJREFUeNpi+P///4EDBxiAGMgCCCAGFB5AADGCRBgYDh48CCRZIJS9vT2QBAggFBkmBiSAogxFBiCAoHogAKIKAlBUYTELAiAmEtABEECk20G6BOmuIl0CIMBQ/IEMkO0myiSSraaaBhZcbkUOs0HuBwDplz5uFJ3Z4gAAAABJRU5ErkJggg==",c='<a tabindex="0" class="wp-color-result" />',d='<div class="wp-picker-holder" />',e='<div class="wp-picker-container" />',f='<input type="button" class="button button-small hidden" />';Color.fn.toString=function(){if(this._alpha<1)return this.toCSS("rgba",this._alpha).replace(/\s+/g,"");var a=parseInt(this._color,10).toString(16);if(this.error)return"";if(a.length<6)for(var b=6-a.length-1;b>=0;b--)a="0"+a;return"#"+a},a.widget("wp.wpColorPicker",a.wp.wpColorPicker,{_create:function(){if(a.support.iris){var g=this,h=g.element;a.extend(g.options,h.data()),g.close=a.proxy(g.close,g),g.initialValue=h.val(),h.addClass("wp-color-picker").hide().wrap(e),g.wrap=h.parent(),g.toggler=a(c).insertBefore(h).css({backgroundColor:g.initialValue}).attr("title",wpColorPickerL10n.pick).attr("data-current",wpColorPickerL10n.current),g.pickerContainer=a(d).insertAfter(h),g.button=a(f),g.options.defaultColor?g.button.addClass("wp-picker-default").val(wpColorPickerL10n.defaultString):g.button.addClass("wp-picker-clear").val(wpColorPickerL10n.clear),h.wrap('<span class="wp-picker-input-wrap" />').after(g.button),h.iris({target:g.pickerContainer,hide:g.options.hide,width:g.options.width,mode:g.options.mode,palettes:g.options.palettes,change:function(c,d){g.options.rgba?(g.toggler.css({"background-image":"url("+b+")"}).html("<span />"),g.toggler.find("span").css({width:"100%",height:"100%",position:"absolute",top:0,left:0,"border-top-left-radius":"3px","border-bottom-left-radius":"3px",background:d.color.toString()})):g.toggler.css({backgroundColor:d.color.toString()}),a.isFunction(g.options.change)&&g.options.change.call(this,c,d)}}),h.val(g.initialValue),g._addListeners(),g.options.hide||g.toggler.click()}},_addListeners:function(){var b=this;b.wrap.on("click.wpcolorpicker",function(a){a.stopPropagation()}),b.toggler.click(function(){b.toggler.hasClass("wp-picker-open")?b.close():b.open()}),b.element.change(function(c){var d=a(this),e=d.val();(""===e||b.element.hasClass("iris-error"))&&(b.options.rgba?(b.toggler.removeAttr("style"),b.toggler.find("span").css("backgroundColor","")):b.toggler.css("backgroundColor",""),a.isFunction(b.options.clear)&&b.options.clear.call(this,c))}),b.toggler.on("keyup",function(a){13!==a.keyCode&&32!==a.keyCode||(a.preventDefault(),b.toggler.trigger("click").next().focus())}),b.button.click(function(c){var d=a(this);d.hasClass("wp-picker-clear")?(b.element.val(""),b.options.rgba?(b.toggler.removeAttr("style"),b.toggler.find("span").css("backgroundColor","")):b.toggler.css("backgroundColor",""),a.isFunction(b.options.clear)&&b.options.clear.call(this,c)):d.hasClass("wp-picker-default")&&b.element.val(b.options.defaultColor).change()})}}),a.widget("a8c.iris",a.a8c.iris,{_create:function(){if(this._super(),this.options.rgba=this.element.data("rgba")||!1,this.element.is(":input")||(this.options.alpha=!1),"undefined"!=typeof this.options.rgba&&this.options.rgba){var b=this,d=(b.element,'<div class="iris-strip iris-slider iris-alpha-slider"><div class="iris-slider-offset iris-slider-offset-alpha"></div></div>'),e=a(d).appendTo(b.picker.find(".iris-picker-inner")),f=e.find(".iris-slider-offset-alpha"),g={aContainer:e,aSlider:f};a.each(g,function(a,c){b.controls[a]=c}),b.controls.square.css({"margin-right":"0"});var h=b.picker.width()-b.controls.square.width()-20,i=h/6,j=h/2-i;a.each(["aContainer","strip"],function(a,c){b.controls[c].width(j).css({"margin-left":i+"px"})}),b._initControls(),b._change()}},_initControls:function(){if(this._super(),this.options.rgba){var a=this,b=a.controls;b.aSlider.slider({orientation:"vertical",min:0,max:100,step:1,value:parseInt(100*a._color._alpha),slide:function(b,c){a._color._alpha=parseFloat(c.value/100),a._change.apply(a,arguments)}})}},_change:function(){this._super();var a=this,c=a.element;if(this.options.rgba){var d=a.controls,e=parseInt(100*a._color._alpha),f=a._color.toRgb(),g=["rgb("+f.r+","+f.g+","+f.b+") 0%","rgba("+f.r+","+f.g+","+f.b+", 0) 100%"],h=a.options.defaultWidth,i=a.options.customWidth,j=a.picker.closest(".wp-picker-container").find(".wp-color-result");if(d.aContainer.css({background:"linear-gradient(to bottom, "+g.join(", ")+"), url("+b+")"}),j.hasClass("wp-picker-open"))if(d.aSlider.slider("value",e),a._color._alpha<1){var k=d.strip.attr("style").replace(/rgba\(([0-9]+,)(\s+)?([0-9]+,)(\s+)?([0-9]+)(,(\s+)?[0-9\.]+)\)/g,"rgb($1$3$5)");d.strip.attr("style",k),c.width(parseInt(h+i))}else c.width(h)}var l=c.data("reset-alpha")||!1;l&&a.picker.find(".iris-palette-container").on("click.palette",".iris-palette",function(){a._color._alpha=1,a.active="external",a._change()})},_addInputListeners:function(a){var b=this,c=100,d=function(c){var d=new Color(a.val()),e=a.val();a.removeClass("iris-error"),d.error?""!==e&&a.addClass("iris-error"):d.toString()!==b._color.toString()&&("keyup"===c.type&&e.match(/^[0-9a-fA-F]{3}$/)||b._setOption("color",d.toString()))};a.on("change",d).on("keyup",b._debounce(d,c)),b.options.hide&&a.one("focus",function(){b.show()})}})}(jQuery),e=d.extend({ui:{input:"input"},events:{},serializeData:function(){var a=Backbone.Marionette.ItemView.prototype.serializeData.apply(this,arguments);return a.value=this.model.setting.get("value"),a.rgba=this.model.get("rgba"),a},addEventListeners:function(){this.listenTo(this.model.setting.collection,"change",this.checkDependencies)},onRender:function(){var a=this;this.ui.input.wpColorPicker({palettes:this.model.get("palettes"),defaultColor:a.getDefaultValue(),change:function(){a.setSettingValue(a.ui.input.wpColorPicker("color"))},clear:function(){a.setSettingValue("")}})},onBeforeDestroy:function(){this.ui.input.wpColorPicker("close")}}),b.exports=e},{"./abstract-control":11}],16:[function(a,b,c){var e,d=a("./abstract-control");e=d.extend({ui:{input:"textarea",default:".js-default"},getTemplate:function(){var a=document.getElementById("tmpl-tailor-control-editor").innerHTML;return _.template(a.replace(new RegExp("tailor-editor","gi"),this.cid).replace(new RegExp("tailor-value","gi"),"<%= value %>"))},addEventListeners:function(){this.listenTo(this.model.setting,"change",this.toggleDefaultButton),this.listenTo(this.model.setting.collection,"change",this.checkDependencies),this.listenTo(app.channel,"list:change:order",this.maybeRefreshEditor)},maybeRefreshEditor:function(a){a.contains(this.el)&&(tinyMCE.execCommand("mceRemoveEditor",!1,this.cid),tinyMCE.execCommand("mceAddEditor",!1,this.cid))},onAttach:function(){var a=this.ui.input,b=this.cid,c=_.extend({},tinyMCEPreInit.qtInit["tailor-editor"],{id:b});quicktags(c),QTags._buttonsInit(),tinyMCEPreInit.mceInit[b]=_.extend({},tinyMCEPreInit.mceInit["tailor-editor"],{id:b,resize:"vertical",height:350,setup:function(b){b.on("change",function(){b.save(),a.change()})}}),switchEditors.go(b,"tmce"),tinymce.execCommand("mceAddEditor",!0,b)},restoreDefaultValue:function(a){var b=this.getDefaultValue();this.setSettingValue(b),tinyMCE.get(this.cid).setContent(b)},onDestroy:function(){tinyMCE.execCommand("mceRemoveEditor",!0,this.cid)}}),b.exports=e},{"./abstract-control":11}],17:[function(a,b,c){var e,d=a("./abstract-control");e=d.extend({ui:{select:".button--select",change:".button--change",remove:".button--remove",thumbnails:".thumbnails",default:".js-default"},events:{"click @ui.select":"selectImages","click @ui.change":"selectImages","click @ui.thumbnails":"selectImages","click @ui.remove":"removeImages","click @ui.default":"restoreDefaultValue"},serializeData:function(){var a=Backbone.Marionette.ItemView.prototype.serializeData.apply(this,arguments),b=this.getDefaultValue();return a.value=this.getSettingValue(),a.showDefault=null!=b&&a.value!=b,a.ids=this.ids(),a},addEventListeners:function(){this.listenTo(this.model.setting,"change",this.render),this.listenTo(this.model.setting.collection,"change",this.checkDependencies)},selectImages:function(){var e,a=this,b=this.ids(),c=this.getSelection(b),d=wp.media({frame:"post",state:b.length?"gallery-edit":"gallery-library",editing:!0,multiple:!0,selection:c});d.on("open",function(){var a=d.views.get(".media-frame-menu")[0];a.$el.children().slice(0,2).hide(),e=JSON.stringify(c.toJSON())}).on("update",function(b){var c=b.pluck("id").join(",");a.setSettingValue(c),_.isEqual(e,JSON.stringify(b.toJSON()))||a.model.setting.trigger("change",a.model.setting,c),a.updateThumbnails(b)}).on("close",function(){d.dispose()}),d.open()},removeImages:function(){this.setSettingValue(""),this.render()},onRender:function(){this.generateThumbnails()},generateThumbnails:function(){var a=this,b=this.ids();if(b.length){var c=this.getSelection(this.ids());c.more().done(function(){c.props.set({query:!1}),c.unmirror(),c.props.unset("orderby"),a.updateThumbnails(c)})}},updateThumbnails:function(a){var b="",c=a.map(function(a){var c,b=a.get("sizes");return c=b.hasOwnProperty("medium")?b.medium.url:b.hasOwnProperty("thumbnail")?b.thumbnail.url:b.hasOwnProperty("full")?b.full.url:""});c.length&&_.each(c,function(a){b+='<li class="thumbnail"><img src="'+a+'"/></li>'}),this.ui.thumbnails.removeClass("is-loading").html(b)},getSelection:function(a){var b=wp.media.query({orderby:"post__in",order:"ASC",type:"image",post__in:a});return new wp.media.model.Selection(b.models,{props:b.props.toJSON(),multiple:!0})},ids:function(){var a=this.getSettingValue();return!!a&&a.split(",")},restoreDefaultValue:function(){this.setSettingValue(this.getDefaultValue())}}),b.exports=e},{"./abstract-control":11}],18:[function(a,b,c){var f,d=Backbone.$,e=a("./abstract-control");f=e.extend({ui:{select:".button--select",change:".button--change",remove:".button--remove",icon:"i",default:".js-default"},events:{"click @ui.select":"openDialog","click @ui.change":"openDialog","click @ui.remove":"removeIcon","click @ui.icon":"openDialog","click @ui.default":"restoreDefaultValue"},addEventListeners:function(){this.listenTo(this.model.setting,"change",this.render),this.listenTo(this.model.setting.collection,"change",this.checkDependencies)},openDialog:function(){var a=this,b={title:"Select Icon",button:window._l10n.select,content:function(){var b=window._kits||{},c=a.getSettingValue();return _.keys(b).length?_.template(document.getElementById("tmpl-tailor-control-icon-select").innerHTML)({kits:b,value:c}):document.getElementById("tmpl-tailor-control-icon-empty").innerHTML},onOpen:function(){var a=this.$el,b=a.find("li"),c=a.find(".icon-kit");this.$el.find(".search--icon").on("input",function(a){var c=this.value.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");c=c.replace(/ /g,")(?=.*");var d=new RegExp("^(?=.*"+c+").+","i");b.each(function(){this.classList.toggle("is-hidden",!d.test(this.getAttribute("title")))})}),this.$el.find(".select--icon").on("change",function(a){var b=this.value;c.removeClass("is-hidden").filter(function(){return this.id!=b}).addClass("is-hidden")})},onValidate:function(){return d("input[name=icon]:checked").val()},onSave:function(){a.setSettingValue(d("input[name=icon]:checked").val())},onClose:function(){this.$el.find(".search--icon").off("input")}};app.channel.trigger("dialog:open",b)},removeIcon:function(){this.setSettingValue("")}}),b.exports=f},{"./abstract-control":11}],19:[function(a,b,c){var e,d=a("./abstract-control");e=d.extend({ui:{select:".button--select",change:".button--change",remove:".button--remove",default:".js-default",thumbnails:".thumbnails",thumbnail:".thumbnail"},events:{"click @ui.select":"openFrame","click @ui.change":"openFrame","click @ui.remove":"removeImage","click @ui.thumbnail":"openFrame","click @ui.default":"restoreDefaultValue"},initialize:function(a){this.frame=wp.media({states:[new wp.media.controller.Library({title:"Select Image",library:wp.media.query({type:["image"]}),multiple:!1,date:!1})]}),this.addEventListeners(),this.checkDependencies(this.model.setting);
},addEventListeners:function(){this.listenTo(this.model.setting,"change",this.render),this.listenTo(this.model.setting.collection,"change",this.checkDependencies),this.frame.on("select",this.selectImage.bind(this))},openFrame:function(){this.frame.open()},selectImage:function(){var a=this.frame.state().get("selection"),b=a.first(),c=b.get("sizes");this.setSettingValue(b.get("id")),this.updateThumbnail(c)},updateThumbnail:function(a){var b;if(a.hasOwnProperty("medium"))b=a.medium.url;else if(a.hasOwnProperty("thumbnail"))b=a.thumbnail.url;else{if(!a.hasOwnProperty("full"))return;b=a.full.url}this.ui.thumbnails.removeClass("is-loading").html('<li class="thumbnail"><img src="'+b+'"/></li>')},removeImage:function(){this.setSettingValue("")},onRender:function(){var a=this,b=this.getSettingValue();if(b){var c=wp.media.attachment(b),d=c.get("sizes");d?this.updateThumbnail(d):c.fetch({success:function(){d=c.get("sizes"),a.updateThumbnail(d)}})}},onDestroy:function(){this.frame.off().dispose()}}),b.exports=e},{"./abstract-control":11}],20:[function(a,b,c){var f,d=Backbone.$,e=a("./abstract-control");f=e.extend({ui:{input:"input",select:".button--select",default:".js-default"},events:{"input @ui.input":"onControlChange","change @ui.input":"onControlChange","click @ui.select":"openDialog","click @ui.default":"restoreDefaultValue"},serializeData:function(){var a=Backbone.Marionette.ItemView.prototype.serializeData.apply(this,arguments),b=this.getDefaultValue();return a.value=this.getSettingValue(),a.placeholder=this.model.get("placeholder"),a.showDefault=null!=b&&a.value!=b,a},search:function(a){var b=this,c=this.$el.find(".search-results");if(c.length){b.$el.addClass("is-searching");var d={data:{s:a,nonce:window._nonces.query},success:function(a){c.html(a)},complete:function(){b.$el.removeClass("is-searching")}};window.ajax.send("tailor_get_links",d)}},openDialog:function(){var a=this,b={title:"Select content",button:window._l10n.select,content:function(){return'<div class="dialog__container"><input class="search--content" type="search" role="search" placeholder="Search"><span class="spinner"></span><div class="search-results"></div></div>'},onOpen:function(){var f,b=this,c="",e=3;this.$el.find(".search--content").on("input",function(g){clearTimeout(f);var h=this.value;h.length>=e&&c!=d.trim(h)&&(f=setTimeout(d.proxy(a.search,b,h),500))})},onValidate:function(){return d("input[name=url]:checked").val()},onSave:function(){var b=d("input[name=url]:checked").val();a.setSettingValue(b),a.ui.input.val(b)},onClose:function(){this.$el.find(".search--content").off("input")}};app.channel.trigger("dialog:open",b)},removeIcon:function(){this.setSettingValue("")},onRestoreDefault:function(){this.render()}}),b.exports=f},{"./abstract-control":11}],21:[function(a,b,c){var d=Marionette.ItemView.extend({template:"#tmpl-tailor-control-list-empty"});b.exports=d},{}],22:[function(a,b,c){var d=Marionette.CompositeView.extend({tagName:"li",className:"list-item",ui:{title:".list-item__title",content:".list-item__content",delete:".js-delete-list-item",close:".js-close-list-item"},triggers:{"click @ui.title":"toggle","click @ui.close":"toggle","click @ui.delete":"delete"},events:{keypress:"onKeyPress"},getChildView:function(a){return Tailor.lookup(a.get("type"),!1,"Controls")},childViewContainer:"#controls",template:"#tmpl-tailor-control-list-item",initialize:function(a){this.settings=a.settings,this._open=!1,this.model.startTracking(),this.addEventListeners()},addEventListeners:function(){this.listenTo(this.settings,"change",this.onChangeSettings),this.listenTo(app.channel,"modal:apply",this.onApplyModal),this.listenTo(app.channel,"modal:close",this.onCloseModal)},updateTitle:function(a,b){this.ui.title.find(":contains("+a+")").html(b)},onKeyPress:function(a){13===a.which&&this.triggerMethod("toggle")},onToggle:function(){this._open?this.slideUp():this.slideDown()},slideUp:function(){var a=this;a._open=!1,a.ui.content.slideUp(150,function(){a.el.classList.remove("is-open")})},slideDown:function(){var a=this;a._open=!0,a.ui.content.slideDown(150,function(){a.el.classList.add("is-open")})},onDelete:function(){var a=this;a.$el.slideUp(250,function(){a.triggerMethod("remove")})},onChangeSettings:function(a){var b=_.clone(this.model.get("atts")),c=a.get("id"),d=a.get("value");"title"==c&&this.updateTitle(b.title,d),b[c]=d,this.model.set("atts",b)},onApplyModal:function(){this.model.stopTracking()},onCloseModal:function(){this.model.resetAttributes()}});b.exports=d},{}],23:[function(a,b,c){var d=Marionette.CompositeView.extend({childView:a("./list-item"),childViewContainer:"#list-items",emptyView:a("./list-empty"),className:function(){return"control control--"+this.model.get("type")},ui:{button:".js-add"},events:{"click @ui.button":"addItem"},collectionEvents:{add:"updateContent",remove:"updateContent",change:"updateContent"},childEvents:{remove:"deleteItem",toggle:"onToggleItem"},template:"#tmpl-tailor-control-list",serializeData:function(){var a=Backbone.Marionette.ItemView.prototype.serializeData.apply(this,arguments);return a.childLabel=this.child.get("label").toLowerCase(),a},childViewOptions:function(a,b){var c=app.channel.request("sidebar:controls",a),d=app.channel.request("sidebar:settings",a),e={model:a,collection:c,settings:d};return e},initialize:function(a){this.element=a.element,this._added=[],this._deleted=[];var b=app.channel.request("sidebar:library",this.element.get("tag"));this.child=app.channel.request("sidebar:library",b.get("child")),this.addEventListeners()},addEventListeners:function(){this.listenTo(app.channel,"modal:apply",this.onApplyModal),this.listenTo(app.channel,"modal:close",this.onCloseModal)},filter:function(a,b,c){return a.get("parent")==this.element.get("id")},onRender:function(){var a=this;this.sortable=Sortable.create(this.$childViewContainer.get(0),{draggable:".list-item",handle:".list-item__title",animation:250,onEnd:function(b){app.channel.trigger("list:change:order",a.el),a.updateOrder()}})},isEmpty:function(){return 0==this.collection.getChildren(this.element).length},onToggleItem:function(a){this.children.each(function(b){b!==a&&b.slideUp()},this)},onAddChild:function(a){this.children.each(function(b){b!==a&&b.slideUp()},this)},addItem:function(){var a=this.collection.getChildren(this.element).length,b=_.first(this.collection.create([{tag:this.child.get("tag"),parent:this.element.get("id"),order:a,atts:{title:this.child.get("label")}}],{}));this._added.push(b)},deleteItem:function(a){for(var b=0;b<this._added.length;b++)this._added[b]==a.model&&this._added.splice(b,1);this.collection.remove(a.model),this._deleted.push(a.model)},onApplyModal:function(){this._deleted=[],this._added=[]},onCloseModal:function(){this.collection.add(this._deleted),this.collection.remove(this._added)},updateOrder:function(){this.children.each(function(a){a.model.set("order",a.$el.index())},this),this.collection.sort({silent:!0}),this.updateContent()},updateContent:function(){var a=this.generateShortcode();this.model.setting.set("value",a)},generateShortcode:function(){var a=this,b="",c=this.element.get("id"),d=this.collection.filter(function(b){return b.get("parent")===c&&!a._deleted.hasOwnProperty(b.cid)});return _.each(d,function(a){b+=a.toShortcode()}),b},onBeforeDestroy:function(){this.sortable.destroy(),this.collection.sort()}});b.exports=d},{"./list-empty":21,"./list-item":22}],24:[function(a,b,c){var e,d=a("./abstract-control");e=d.extend({ui:{input:"input",default:".js-default"},templateHelpers:{checked:function(a){return this.value===a?"checked":""}},addEventListeners:function(){this.listenTo(this.model.setting,"change",this.render),this.listenTo(this.model.setting.collection,"change",this.checkDependencies)},onControlChange:function(a){this.setSettingValue(this.ui.input.filter(":checked").val())}}),b.exports=e},{"./abstract-control":11}],25:[function(a,b,c){var e,d=a("./abstract-control");e=d.extend({ui:{range:"input[type=range]",input:"input[type=text]",default:".js-default"},templateHelpers:{inputAttrs:function(){var a="";return _.each(this.attrs,function(b,c){a+=c+'="'+b+'"'}),a}},serializeData:function(){var a=Backbone.Marionette.ItemView.prototype.serializeData.apply(this,arguments),b=this.getDefaultValue();return a.value=this.getSettingValue(),a.showDefault=null!=b&&a.value!=b,a.attrs=this.model.get("input_attrs"),a},events:{"input @ui.range":"onControlChange","change @ui.input":"onControlChange","click @ui.default":"restoreDefaultValue"},onControlChange:function(a){var b=a.target.value;this.ui.input.val(b),this.ui.range.val(b),this.setSettingValue(b)},restoreDefaultValue:function(a){this.setSettingValue(this.getDefaultValue()),this.render()}}),b.exports=e},{"./abstract-control":11}],26:[function(a,b,c){var e,d=a("./abstract-control");e=d.extend({ui:{input:"select",default:".js-default"},templateHelpers:{selected:function(a){var b=this.value.split(",");return-1!==b.indexOf(a)?"selected":""}},onRender:function(){this.ui.input.select2()},onControlChange:function(a){for(var b=this.ui.input.get(0),c=[],d=0;d<b.length;d++)b[d].selected&&c.push(b[d].value);this.setSettingValue(c.join(","))},restoreDefaultValue:function(a){this.setSettingValue(this.getDefaultValue()),this.render()},onDestroy:function(){this.ui.input.select2("destroy")}}),b.exports=e},{"./abstract-control":11}],27:[function(a,b,c){var e,d=a("./abstract-control");e=d.extend({ui:{input:"select",default:".js-default"},addEventListeners:function(){this.listenTo(this.model.setting,"change",this.render),this.listenTo(this.model.setting.collection,"change",this.checkDependencies)}}),b.exports=e},{"./abstract-control":11}],28:[function(a,b,c){var e,d=a("./abstract-control");e=d.extend({ui:{input:"input",default:".js-default",link:".js-link"},events:{"input @ui.input":"onControlChange","change @ui.input":"onControlChange","click @ui.default":"restoreDefaultValue","click @ui.link":"onLinkChange"},initialize:function(a){this.linked=!0,this.addEventListeners(),this.checkDependencies(this.model.setting)},onRender:function(){this.ui.link.toggleClass("is-active",this.linked)},onLinkChange:function(){this.linked=!this.linked,this.ui.link.toggleClass("is-active",this.linked)},serializeData:function(){var a=Backbone.Marionette.ItemView.prototype.serializeData.apply(this,arguments),b=this.getDefaultValue();a.value=this.getSettingValue(),a.showDefault=null!=b&&a.value!=b,a.choices=[];var c=a.value.split("-"),d=this.model.get("choices");for(var e in d)d.hasOwnProperty(e)&&(a.choices[d[e]]=c.shift()||"");return a},onControlChange:function(a){var b;if(this.linked){b=Array(this.ui.input.length).fill(a.currentTarget.value);var c=this.ui.input.filter(function(b,c){return c!=a.currentTarget});c.val(a.currentTarget.value)}else b=[],_.each(this.ui.input,function(a,c){b.push(a.value)},this);this.setSettingValue(b.join("-"))},restoreDefaultValue:function(a){this.setSettingValue(this.getDefaultValue()),this.render()}}),b.exports=e},{"./abstract-control":11}],29:[function(a,b,c){var e,d=a("./abstract-control");e=d.extend({ui:{input:"input",default:".js-default"},templateHelpers:{checked:function(){return this.value?"checked":""}},onControlChange:function(a){this.setSettingValue(this.ui.input.get(0).checked?1:"")},restoreDefaultValue:function(a){this.setSettingValue(this.getDefaultValue()),this.render()}}),b.exports=e},{"./abstract-control":11}],30:[function(a,b,c){var e,d=a("./abstract-control");e=d.extend({ui:{input:"input",default:".js-default"},templateHelpers:{inputAttrs:function(){var a="";return _.each(this.attrs,function(b,c){a+=c+'="'+b+'"'}),a}},serializeData:function(){var a=Backbone.Marionette.ItemView.prototype.serializeData.apply(this,arguments),b=this.getDefaultValue();return a.value=this.getSettingValue(),a.showDefault=null!=b&&a.value!=b,a.attrs=this.model.get("input_attrs"),a},onRestoreDefault:function(){this.render()}}),b.exports=e},{"./abstract-control":11}],31:[function(a,b,c){var e,d=a("./abstract-control");e=d.extend({ui:{input:"textarea",default:".js-default"},onRestoreDefault:function(){this.render()}}),b.exports=e},{"./abstract-control":11}],32:[function(a,b,c){var f,d=Backbone.$,e=a("./abstract-control");f=e.extend({ui:{select:".button--select",enterUrl:".button--enter",change:".button--change",remove:".button--remove",default:".js-default",preview:".video-preview"},events:{"click @ui.select":"openFrame","click @ui.enterUrl":"openDialog","click @ui.change":"openFrame","click @ui.remove":"removeVideo","click @ui.default":"restoreDefaultValue"},initialize:function(a){this.frame=wp.media({states:[new wp.media.controller.Library({title:"Select Video",library:wp.media.query({type:["video"]}),multiple:!1,date:!1})]}),this.addEventListeners(),this.checkDependencies(this.model.setting)},addEventListeners:function(){this.listenTo(this.model.setting,"change",this.render),this.listenTo(this.model.setting.collection,"change",this.checkDependencies),this.frame.on("select",this.selectVideo.bind(this))},openFrame:function(){this.frame.open()},selectVideo:function(){var a=this.frame.state().get("selection"),b=a.first();this.setSettingValue(b.get("id")),this.updatePreview(b)},openDialog:function(){var a=this,b={title:"Enter URL",button:window._l10n.select,content:function(){return'<div class="dialog__container"><input class="search--content" type="search" role="search"></div>'},onValidate:function(){var a=d(".search--content").val();return a&&/^(ftp|http|https):\/\/[^ "]+$/.test(a)},onSave:function(){var b=d(".search--content").val();a.setSettingValue(b)},onClose:function(){this.$el.find(".search--content").off("input")}};app.channel.trigger("dialog:open",b)},removeVideo:function(){this.setSettingValue("")},onRender:function(){var a=this,b=this.getSettingValue();if(b&&_.isNumber(b)){var c=wp.media.attachment(b);c.get("url")?a.updatePreview(c):c.fetch({success:function(){a.updatePreview(c)}})}},updatePreview:function(a){var b=a.get("url"),c=a.get("mime");this.ui.preview.removeClass("is-loading").html('<video controls><source src="'+b+'" type="'+c+'"></video>')},onDestroy:function(){this.frame.dispose()},initializePlayer:function(){var a=window._wpmejsSettings||{},b=this.ui.preview.get(0).firstChild;this.player=new MediaElementPlayer(b,a)},destroyPlayer:function(){this.player&&wp.media.mixin.removePlayer(this.player)}}),b.exports=f},{"./abstract-control":11}],33:[function(a,b,c){var e,d=window.jQuery;e=Marionette.ItemView.extend({tagName:"li",className:function(){return"control control--"+this.model.get("type")},ui:{default:".js-default"},events:{"input *":"onControlChange","change *":"onControlChange","click @ui.default":"restoreDefaultValue"},getTemplateId:function(){return"tmpl-tailor-widget-form-"+this.model.get("widget_id_base")},getTemplate:function(){var a=document.getElementById(this.getTemplateId()),b="";return a&&(b=_.template(a.innerHTML)),b},onRender:function(){this.$el.find("label").addClass("control__title").each(function(){var a=d(this);a.html(this.innerHTML.replace(":",""))});var a=this.getSettingValue();if(!_.isEmpty(a)){var b=this.$el,c=this.model.get("widget_id_base");_.each(a,function(a,d){var e=b.find('[name="widget-'+c+"[__i__]["+d+']"]');e.length&&("checkbox"==e[0].type||"radio"==e[0].type?e.attr("checked","true"):e.val(a))})}},onControlChange:function(a){var b=this.$el.find("input, select, radio, textarea").serializeArray(),c={};d.each(b,function(){var a=this.name.match(/\[(.*?)\]/g),b=a[1].substring(1,a[1].length-1);"undefined"!=typeof c[b]?(c[b].push||(c[b]=[c[b]]),c[b].push(this.value||"")):c[b]=this.value||""}),this.setSettingValue(c),a.preventDefault(),a.stopImmediatePropagation()},getSettingValue:function(){return this.model.setting.get("value")},setSettingValue:function(a){this.model.setting.set("value",a)}}),b.exports=e},{}],34:[function(a,b,c){var d=Marionette.CompositeView.extend({ui:{backButton:".back-button"},triggers:{"click @ui.backButton":"back:home"},behaviors:{Panel:{}},emptyView:Tailor.Panels.Empty,emptyViewOptions:function(){return{type:this.model.get("type")}},childViewContainer:"#items",getChildView:function(){return Tailor.lookup(this.model.get("type"),!1,"Items")},filter:function(a,b,c){switch(this.model.get("type")){case"library":return!_.contains(["tailor_row"],a.get("tag"))&&"child"!=a.get("type");case"default":return a.get("panel")===this.model.get("id");default:return!0}},getTemplate:function(){var a=this.model.get("type")||"default";return"#tmpl-tailor-panel-"+a},serializeData:function(){var a=Marionette.ItemView.prototype.serializeData.apply(this,arguments);return a.items=this.collection,a},onShow:function(){this.ui.backButton.get(0).focus()}});b.exports=d},{}],35:[function(a,b,c){var d=Marionette.ItemView.extend({className:"empty",initialize:function(a){this.type=a.type},getTemplate:function(){var a=this.type||"default";return"#tmpl-tailor-panel-"+a+"-empty"}});b.exports=d},{}],36:[function(a,b,c){var d=Marionette.CompositeView.extend({ui:{backButton:".back-button"},triggers:{"click @ui.backButton":"back:panel"},behaviors:{Panel:{}},emptyView:a("./section-empty"),childViewContainer:"#controls",initialize:function(a){this.panel=a.panel},getChildView:function(a){return Tailor.lookup(a.get("type"),!1,"Controls")},filter:function(a,b,c){return"default"!==this.model.get("type")||a.get("section")===this.model.get("id")},getTemplate:function(){return"#tmpl-tailor-section-"+this.model.get("type")},serializeData:function(){var a=Marionette.ItemView.prototype.serializeData.apply(this,arguments);return a.panel=this.panel.get("title"),a},onShow:function(){this.ui.backButton.get(0).focus(),this.children.each(function(a){"code"===a.model.get("type")&&a.editor.refresh()},this)}});b.exports=d},{"./section-empty":37}],37:[function(a,b,c){var d=Marionette.ItemView.extend({className:"empty",getTemplate:function(){var a=this.model.get("type")||"default";return"#tmpl-tailor-section-"+a+"-empty"}});b.exports=d},{}],38:[function(a,b,c){var d=Backbone.Collection.extend({model:a("../models/control"),initialize:function(a,b){b&&b.settings&&(this.settings=b.settings),this.addEventListeners()},addEventListeners:function(){this.listenTo(this,"reset",this.onReset)},onReset:function(){this.settings&&this.each(function(a){var b=this.settings.findWhere({id:a.get("setting")});b&&(a.setting=b)},this)}});b.exports=d},{"../models/control":46}],39:[function(a,b,c){var e,d=a("./searchable");e=d.extend({model:function(a,b){var c=Tailor.lookup(a.tag,a.type,"Models");return new c(a,b)},comparator:"label",getHaystack:function(a){return[a.get("label"),a.get("type"),a.get("description"),a.get("badge"),a.get("tag")].join(" ")}}),b.exports=e},{"./searchable":41}],40:[function(a,b,c){var d=Backbone.Collection.extend({model:a("../models/panel")});b.exports=d},{"../models/panel":50}],41:[function(a,b,c){var e;Backbone.$;e=Backbone.Collection.extend({doSearch:function(a){this.terms!==a&&(this.terms=a,this.terms.length>0&&this.search(this.terms),""===this.terms&&this.each(function(a){a.set("match",!0)}))},search:function(a){var b,c;a=a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),a=a.replace(/ /g,")(?=.*"),b=new RegExp("^(?=.*"+a+").+","i"),this.each(function(a){c=this.getHaystack(a),a.set("match",b.test(c))},this)}}),b.exports=e},{}],42:[function(a,b,c){var d=Backbone.Collection.extend({model:a("../models/section")});b.exports=d},{"../models/section":51}],43:[function(a,b,c){var d=Backbone.Collection.extend({model:a("../models/setting"),initialize:function(a,b){b&&b.element&&(this.element=b.element),this.addEventListeners()},addEventListeners:function(){this.listenTo(this,"reset",this.load)},load:function(){var a=this.element.get("atts");this.each(function(b){b.set("value",a[b.get("id")]||"")},this)}});b.exports=d},{"../models/setting":52}],44:[function(a,b,c){var d=Backbone.Collection.extend({maxSize:50,active:null,comparator:function(a){return-a.get("timestamp")},initialize:function(){this.addEventListeners()},addEventListeners:function(){this.listenTo(this,"add",this.checkLength),this.listenToOnce(app.channel,"canvas:initialize",function(){this.elements=app.channel.request("canvas:elements"),this.save(window._l10n.initialized)})},save:function(a){if(this.active){var b=this.indexOf(this.active);b>0&&this.remove(this.slice(0,b))}var c=this.add({label:a||"",elements:this.elements?this.elements.toJSON():[],time:this.getTime(),timestamp:_.now()});this.setActive(c)},getTime:function(){var d,a=new Date,b=a.getHours(),c=":";return b>12?(b-=12,d=" PM"):d=" AM",b+c+("0"+a.getMinutes()).slice(-2)+c+("0"+a.getSeconds()).slice(-2)+d},restore:function(a){var b=this.findWhere({timestamp:a});if(b&&b!==this.getActive()){this.setActive(b);var c=b.get("elements");app.channel.trigger("elements:reset",c)}},undo:function(){if(this.length){var a=this.at(this.indexOf(this.getActive())+1);a&&this.restore(a.get("timestamp"))}},redo:function(){if(this.length){var a=this.at(this.indexOf(this.getActive())-1);a&&this.restore(a.get("timestamp"))}},checkLength:function(){this.length>this.maxSize&&this.pop()},setActive:function(a){this.active=a,this.trigger("change:active",a)},getActive:function(){return this.active}});b.exports=d},{}],45:[function(a,b,c){var e,d=a("./searchable");e=d.extend({model:a("../models/template"),comparator:"name",getHaystack:function(a){return[a.get("id"),a.get("label")].join(" ")}}),b.exports=e},{"../models/template":53,"./searchable":41}],46:[function(a,b,c){var d=Backbone.Model.extend({defaults:{id:"",label:"",description:"",type:"",choices:{},priority:0,setting:"",value:null,section:""}});b.exports=d},{}],47:[function(a,b,c){var d=Backbone.Model.extend({defaults:function(){return{label:"",description:"",tag:"",icon:"",sections:[],controls:[],type:"default",child:"",collection:"library"}},initialize:function(){this.addEventListeners()},addEventListeners:function(){this.listenTo(this,"element:add:top",this.insertBefore),this.listenTo(this,"element:add:bottom",this.insertAfter),this.listenTo(this,"element:add:left",this.columnBefore),this.listenTo(this,"element:add:right",this.columnAfter)},insertBefore:function(a){this.insertAtIndex(a.model,a.model.get("order"))},insertAfter:function(a){this.insertAtIndex(a.model,a.model.get("order")+1)},insertAtIndex:function(a,b){var c="tailor_content",d=a.collection.create([{tag:c,atts:{}},{tag:c,atts:{}}],{silent:!0});a.collection.createContainer(this,a.get("parent"),b,d)},columnBefore:function(a){var d,b=a.model.get("parent"),c="tailor_content";if("tailor_column"==a.model.get("tag")){var e=a.model.collection.createColumn(b,a.model.get("order")-1);d=a.model.collection.create([{tag:c,atts:{}},{tag:c,atts:{}}],{silent:!0}),a.model.collection.createContainer(this,e.get("id"),0,d)}else{var f=a.model.collection.createRow(b,a.model.get("order"));a.model.collection.insertChild(a.model,_.last(f)),d=a.model.collection.create([{tag:c,atts:{}},{tag:c,atts:{}}],{silent:!0}),a.model.collection.createContainer(this,_.first(f).get("id"),0,d)}},columnAfter:function(a){var d,b=a.model.get("parent"),c="tailor_content";if("tailor_column"==a.model.get("tag")){var e=a.model.collection.createColumn(b,a.model.get("order"));d=a.model.collection.create([{tag:c,atts:{}},{tag:c,atts:{}}],{silent:!0}),a.model.collection.createContainer(this,e.get("id"),0,d)}else{var f=a.model.collection.createRow(b,a.model.get("order"));a.model.collection.insertChild(a.model,_.first(f)),d=a.model.collection.create([{tag:c,atts:{}},{tag:c,atts:{}}],{silent:!0}),a.model.collection.createContainer(this,_.last(f).get("id"),0,d)}}});b.exports=d},{}],48:[function(a,b,c){var d=Backbone.Model.extend({defaults:function(){return{label:"",description:"",tag:"",icon:"",sections:[],controls:[],type:"default",child:"",collection:"library"}},initialize:function(){this.addEventListeners()},addEventListeners:function(){this.listenTo(this,"element:add:top",this.insertBefore),this.listenTo(this,"element:add:bottom",this.insertAfter),this.listenTo(this,"element:add:left",this.columnBefore),this.listenTo(this,"element:add:right",this.columnAfter),this.listenTo(this,"element:add:center",this.createChild)},insertBefore:function(a){this.insertAtIndex(a.model,a.model.get("order")-1)},insertAfter:function(a){this.insertAtIndex(a.model,a.model.get("order"))},insertAtIndex:function(a,b){a.collection.createWrapper(this.get("tag"),a.get("parent"),b)},columnBefore:function(a){var b=a.model.get("parent"),c=a.model.get("order")-1;if("tailor_column"==a.model.get("tag")){var e=a.model.collection.createColumn(b,c);a.model.collection.createWrapper(this.get("tag"),e.get("id"),0)}else{var f=a.model.collection.createRow(b,c);a.model.collection.insertChild(a.model,_.last(f)),a.model.collection.createWrapper(this.get("tag"),_.first(f).get("id"),0)}},columnAfter:function(a){var b=a.model.get("parent"),c=a.model.get("order");if("tailor_column"==a.model.get("tag")){var e=a.model.collection.createColumn(b,c);a.model.collection.createWrapper(this.get("tag"),e.get("id"),0)}else{var f=a.model.collection.createRow(b,c);a.model.collection.insertChild(a.model,_.first(f)),a.model.collection.createWrapper(this.get("tag"),_.last(f).get("id"),0)}},createChild:function(a){var b=a.model.get("id"),c=a.model.get("child"),d=a.model.collection.where({parent:b,tag:c}).length,e=a.model.collection.createWrapper(c,b,d,!1);a.model.collection.createWrapper(this.get("tag"),e.get("id"),0)}});b.exports=d},{}],49:[function(a,b,c){var d=Backbone.Model.extend({defaults:function(){return{label:"",description:"",tag:"",icon:"",sections:[],controls:[],type:"default",child:"",collection:"library"}},initialize:function(){this.addEventListeners()},addEventListeners:function(){this.listenTo(this,"element:add:top",this.insertBefore),this.listenTo(this,"element:add:bottom",this.insertAfter),this.listenTo(this,"element:add:left",this.columnBefore),this.listenTo(this,"element:add:right",this.columnAfter),this.listenTo(this,"element:add:center",this.createChild)},insertBefore:function(a){this.insertAtIndex(a.model,a.model.get("order")-1)},insertAfter:function(a){this.insertAtIndex(a.model,a.model.get("order"))},insertAtIndex:function(a,b){a.collection.create([{tag:this.get("tag"),label:this.get("label"),parent:a.get("parent"),type:this.get("type"),order:b}],{})},columnBefore:function(a){var b=a.model.get("parent");if("tailor_column"==a.model.get("tag")){var c=a.model.collection.createColumn(b,a.model.get("order")-1);a.model.collection.create([{tag:this.get("tag"),label:this.get("label"),parent:c.get("id"),type:this.get("type"),order:0}],{at:0})}else{var d=a.model.collection.createRow(b,a.model.get("order"));a.model.collection.create([{tag:this.get("tag"),label:this.get("label"),parent:_.first(d).get("id"),type:this.get("type"),order:0}],{at:0}),a.model.collection.insertChild(a.model,_.last(d))}},columnAfter:function(a){var b=a.model.get("parent");if("tailor_column"==a.model.get("tag")){var c=a.model.collection.createColumn(b,a.model.get("order"));a.model.collection.create([{tag:this.get("tag"),label:this.get("label"),parent:c.get("id"),type:this.get("type"),order:0}],{at:0})}else{var d=a.model.collection.createRow(b,a.model.get("order"));a.model.collection.create([{tag:this.get("tag"),label:this.get("label"),parent:_.last(d).get("id"),type:this.get("type"),order:0}],{at:0}),a.model.collection.insertChild(a.model,_.first(d))}},createChild:function(a){var b=a.model.get("id"),c=a.model.get("child"),d=a.model.collection.where({parent:b,tag:c}).length,e=a.model.collection.createWrapper(c,b,d,!1);a.model.collection.create([{tag:this.get("tag"),label:this.get("label"),parent:e.get("id"),type:this.get("type"),order:0}],{at:0})}});b.exports=d},{}],50:[function(a,b,c){var d=Backbone.Model.extend({defaults:{id:"",title:"",description:"",collection:"",priority:0}});b.exports=d},{}],51:[function(a,b,c){var d=Backbone.Model.extend({defaults:{id:"",title:"",description:"",priority:0,panel:""}});b.exports=d},{}],52:[function(a,b,c){var d=Backbone.Model.extend({defaults:{id:"",type:"",value:"",default:null}});b.exports=d},{}],53:[function(a,b,c){var d=Backbone.Model.extend({defaults:function(){return{id:this.cid,label:"",collection:"template"}},initialize:function(){this.addEventListeners()},addEventListeners:function(){this.listenTo(this,"element:add:top",this.insertBefore),this.listenTo(this,"element:add:bottom",this.insertAfter),this.listenTo(this,"element:add:left",this.columnBefore),this.listenTo(this,"element:add:right",this.columnAfter),this.listenTo(this,"element:add:center",this.createChild)},createChild:function(a){var b=a.model.get("id"),c=a.model.get("child"),d=a.model.collection.where({parent:b,tag:c}).length,e=a.model.collection.createWrapper(c,b,d,!1);app.channel.trigger("template:load",this,e.get("id"),0)},columnBefore:function(a){var b=a.model.get("parent");if("tailor_column"==a.model.get("tag")){var c=a.model.collection.createColumn(b,a.model.get("order")-1);app.channel.trigger("template:load",this,c.get("id"),0)}else{var d=a.model.collection.createRow(b,a.model.get("order"));app.channel.trigger("template:load",this,_.first(d).get("id"),0),a.model.collection.insertChild(a.model,_.last(d))}},columnAfter:function(a){var b=a.model.get("parent");if("tailor_column"==a.model.get("tag")){var c=a.model.collection.createColumn(b,a.model.get("order"));app.channel.trigger("template:load",this,c.get("id"),0)}else{var d=a.model.collection.createRow(b,a.model.get("order"));app.channel.trigger("template:load",this,_.last(d).get("id"),0),a.model.collection.insertChild(a.model,_.first(d))}},insertBefore:function(a){app.channel.trigger("template:load",this,a.model.get("parent"),a.model.get("order")-1)},insertAfter:function(a){app.channel.trigger("template:load",this,a.model.get("parent"),a.model.get("order"))}});b.exports=d},{}],54:[function(a,b,c){var d=Backbone.Marionette.Region.extend({initialize:function(){this.$overlay=jQuery('<div id="overlay"></div>')},onShow:function(a,b,c){this.el.classList.add("is-visible"),this.$overlay.on("click",jQuery.proxy(this.empty,this)).appendTo("body")},onEmpty:function(a,b,c){this.el.classList.remove("is-visible"),this.$overlay.off().detach()}});b.exports=d},{}],55:[function(a,b,c){var e,d=a("./show/dialog");e=Marionette.Module.extend({onStart:function(){var a={showDialog:function(a){app.dialog.show(new d(a))}};this.listenTo(app.channel,"dialog:open",a.showDialog),app.channel.trigger("module:dialog:ready",this)}}),b.exports=e},{"./show/dialog":56}],56:[function(a,b,c){var e;window.jQuery;e=Backbone.Marionette.ItemView.extend({className:"dialog",defaults:{title:"",content:"",button:""},ui:{close:".js-close",content:".dialog__content",save:".js-save"},events:{input:"onChange",change:"onChange"},triggers:{"click @ui.close":"close","click @ui.save":"save"},template:"#tmpl-tailor-dialog",serializeData:function(){return{title:this.title,content:this.content,button:this.button}},initialize:function(a){this.title=a.title||this.defaults.title,this.content=a.content||this.defaults.content,this.button=a.button||this.defaults.button,this.callbacks={validate:a.onValidate,open:a.onOpen,save:a.onSave,close:a.onClose}},onBeforeRender:function(){"function"==typeof this.content&&(this.content=this.content.call(this))},onDomRefresh:function(){"function"==typeof this.callbacks.open&&this.callbacks.open.call(this),this.validate()},onChange:function(){this.validate()},validate:function(){"function"==typeof this.callbacks.validate&&this.ui.save.prop("disabled",!this.callbacks.validate.call(this))},onSave:function(){"function"==typeof this.callbacks.save&&this.callbacks.save.call(this),this.onClose()},onClose:function(){"function"==typeof this.callbacks.close&&this.callbacks.close.call(this),this.triggerMethod("destroy")}}),b.exports=e},{}],57:[function(a,b,c){var f,d=a("../../entities/collections/snapshots"),e=a("./show/snapshot-menu-item");Tailor.Items.History=e,f=Marionette.Module.extend({onBeforeStart:function(){var a=this;a.collection=new d;var b={getSnapshot:function(b){return b?a.collection.findWhere({id:b}):a.collection}};app.channel.reply("sidebar:history",b.getSnapshot);
},onStart:function(a){this.l10n=a.l10n,this.addEventListeners(),app.channel.trigger("module:history:ready",this)},addEventListeners:function(){this.listenTo(app.channel,"element:add",this.onAddElement),this.listenTo(app.channel,"element:copy",this.onCopyElement),this.listenTo(app.channel,"element:move",this.onMoveElement),this.listenTo(app.channel,"modal:apply",this.onEditElement),this.listenTo(app.channel,"element:delete",this.onDeleteElement),this.listenTo(app.channel,"element:resize",this.onResizeElement),this.listenTo(app.channel,"element:change:order",this.onReorderElement),this.listenTo(app.channel,"template:add",this.onAddTemplate),this.listenTo(app.channel,"history:restore",this.restoreSnapshot),this.listenTo(app.channel,"history:undo",this.undoStep),this.listenTo(app.channel,"history:redo",this.redoStep)},onAddElement:function(a){"library"==a.get("collection")&&this.saveSnapshot(this.l10n.added+" "+a.get("label"))},onEditElement:function(a,b){this.saveSnapshot(this.l10n.edited+" "+b.get("label"))},onCopyElement:function(a){this.saveSnapshot(this.l10n.copied+" "+a.get("label"))},onMoveElement:function(a){this.saveSnapshot(this.l10n.moved+" "+a.get("label"))},onDeleteElement:function(a){this.saveSnapshot(this.l10n.deleted+" "+a.get("label"))},onResizeElement:function(a){this.saveSnapshot(this.l10n.resized+" "+a.get("label"))},onReorderElement:function(a){this.saveSnapshot(this.l10n.reordered+" "+a.get("label"))},onAddTemplate:function(a){this.saveSnapshot(this.l10n.added+" "+this.l10n.template+" - "+a.get("label"))},saveSnapshot:function(a){this.collection.save(a)},restoreSnapshot:function(a){this.collection.restore(a)},undoStep:function(){this.collection.undo()},redoStep:function(){this.collection.redo()}}),b.exports=f},{"../../entities/collections/snapshots":44,"./show/snapshot-menu-item":58}],58:[function(a,b,c){var e,d=Backbone.$;e=Marionette.ItemView.extend({events:{click:"restore",keypress:"onKeyPress"},template:"#tmpl-tailor-panel-history-item",initialize:function(){this.addEventListeners()},addEventListeners:function(){this.listenTo(this.model.collection,"change:active",this.toggleClass)},onRender:function(){this.toggleClass()},attachElContent:function(a){var b=d(a);return this.$el.replaceWith(b),this.setElement(b),this.el.setAttribute("tabindex",0),this},onKeyPress:function(a){13===a.which&&this.restore()},restore:function(){var a=this.model.get("timestamp");app.channel.trigger("before:history:restore",a),app.channel.trigger("history:restore",a)},toggleClass:function(a){a=a||this.model.collection.getActive(),this.$el.toggleClass("is-active",a===this.model)}}),b.exports=e},{}],59:[function(a,b,c){var f,d=a("../../entities/collections/library"),e=a("./show/library-menu-item");Tailor.Items.Library=e,f=Marionette.Module.extend({onBeforeStart:function(a){var b=new d(a.library),c={getLibraryItem:function(a){return a?b.findWhere({tag:a}):b}};app.channel.reply("sidebar:library",c.getLibraryItem)},onStart:function(){app.channel.trigger("module:library:ready",this)}}),b.exports=f},{"../../entities/collections/library":39,"./show/library-menu-item":60}],60:[function(a,b,c){var e,d=Backbone.$;e=Marionette.ItemView.extend({events:{click:"onClick",keypress:"onKeyPress"},modelEvents:{"change:match":"onSearch"},behaviors:{Draggable:{}},onClick:function(){var a=this.el;if(!a.classList.contains("is-inactive")){var b=function(c){a.removeEventListener(window.animationEndName,b),a.classList.remove("shake")};Modernizr.cssanimations&&(a.addEventListener(window.animationEndName,b),a.classList.add("shake")),Tailor.Notify(window._l10n.dragElement,"warning")}},getTemplate:function(){return"#tmpl-tailor-panel-library-item"},attachElContent:function(a){var b=d(a);return this.$el.replaceWith(b),this.setElement(b),this},onSearch:function(a){this.el.style.display=a.get("match")?"block":"none"}}),b.exports=e},{}],61:[function(a,b,c){var d=Backbone.Marionette.Region.extend({onShow:function(a,b,c){this.el.classList.add("is-visible");var d=this.el.getBoundingClientRect(),e=this.el.style.width?this.el.style.width:d.width;this.el.style.width=e+"px",this.el.style.height||(this.el.style.height=window.innerHeight-40+"px"),this.el.style.top||(this.el.style.top="20px"),this.el.style.left||(document.documentElement.dir&&"rtl"==document.documentElement.dir?this.el.style.left="20px":this.el.style.left=window.innerWidth-(d.width+20)+"px"),this.updateClassName(e),this.listenTo(a,"modal:resize",this.onResize)},onResize:function(a,b){this.updateClassName(a)},updateClassName:function(a){this.$el.toggleClass("is-x-small",a<480).toggleClass("is-small",481<a&&a<767).toggleClass("is-medium",768<a&&a<979).toggleClass("is-large",980<a&&a<1199).toggleClass("is-x-large",a>=1200)},onEmpty:function(a,b,c){this.el.classList.remove("is-visible"),this.stopListening(a,"modal:resize",this.onResize)}});b.exports=d},{}],62:[function(a,b,c){var e,d=a("./show/modal");e=Marionette.Module.extend({onStart:function(){var a={openModal:function(a){if(app.modal.hasView()){if(a===app.modal.currentView.model)return;app.modal.currentView.triggerMethod("close")}app.modal.show(new d({model:a}))},closeModal:function(){app.modal.empty()}};this.listenTo(app.channel,"modal:open",a.openModal),this.listenTo(app.channel,"elements:reset",a.closeModal),app.channel.trigger("module:modal:ready",this)}}),b.exports=e},{"./show/modal":65}],63:[function(a,b,c){var d=Marionette.ItemView.extend({className:"empty",template:"#tmpl-tailor-modal-empty"});b.exports=d},{}],64:[function(a,b,c){var d=Marionette.ItemView.extend({className:"empty",template:"#tmpl-tailor-section-default-empty"});b.exports=d},{}],65:[function(a,b,c){var f,d=a("./sections"),e=a("./tabs");f=Marionette.LayoutView.extend({className:"modal",ui:{close:".js-close",apply:".js-apply"},behaviors:{Resizable:{ui:{handle:".modal__title"}}},triggers:{"click @ui.close":"close","click @ui.apply":"apply"},modelEvents:{destroy:"destroy"},template:"#tmpl-tailor-modal",regions:{tabs:"#tailor-modal-tabs",sections:"#tailor-modal-sections"},initialize:function(){this.isModified=!1,this.settings=app.channel.request("sidebar:settings",this.model),this.addEventListeners(),app.channel.trigger("modal:initialize",this,this.model)},addEventListeners:function(){this.listenTo(this.settings,"change",this.onChange)},onRender:function(){var a=this.model,b=app.channel.request("sidebar:sections",a),c=app.channel.request("sidebar:controls",a);this.showChildView("sections",new d({element:a,collection:b,controls:c})),b.length>1&&(this.showChildView("tabs",new e({collection:b})),this.el.classList.add("has-sections")),a.collection.trigger("edit",a,!0)},onShow:function(){this.ui.close.focus()},onChange:function(a){this.isModified=!0,this.ui.apply.attr("disabled",!1);var b=this.model;b.isTracking()||b.startTracking();var c=a.get("refresh"),d=c.hasOwnProperty("method")&&"js"==c.method;if(d&&c.hasOwnProperty("dependencies"))for(var e in c.dependencies)if(c.dependencies.hasOwnProperty(e)&&_.has(c.dependencies[e],"condition")&&_.has(c.dependencies[e],"value")){var f=a.collection.get(e);if(f&&!Tailor.Helpers.checkCondition(c.dependencies[e].condition,f.get("value"),c.dependencies[e].value)){d=!1;break}}b.set("atts",this.atts(),{silent:d}),d&&b.trigger("change:setting",a,b),app.channel.trigger("canvas:reset")},onApply:function(){this.model.stopTracking(),this.model.set("atts",this.atts()),app.channel.trigger("modal:apply",this,this.model),this.triggerMethod("destroy")},onClose:function(){if(this.isModified){var a=confirm(window._l10n.confirmElement);!0===a?this.triggerMethod("apply"):this.model.resetAttributes()}app.channel.trigger("modal:close",this),this.triggerMethod("destroy")},onDestroy:function(){this.model.collection.trigger("edit",this.model,!1),app.channel.trigger("modal:destroy",this,this.model)},atts:function(){var a={};return this.settings.each(function(b){a[b.get("id")]=b.get("value")},this),a}}),b.exports=f},{"./sections":67,"./tabs":69}],66:[function(a,b,c){var d=Marionette.CollectionView.extend({tagName:"ul",className:"controls controls--modal",emptyView:a("./empty-section"),getChildView:function(a){return Tailor.lookup(a.get("type"),!1,"Controls")},childViewOptions:function(a,b){var c={model:a};return"list"===a.get("type")&&(c.element=this.element,c.collection=this.element.collection),c},filter:function(a,b,c){return a.get("section")===this.model.get("id")},initialize:function(a){this.model=a.model,this.element=a.element,this.addEventListeners()},addEventListeners:function(){this.listenTo(this.model.collection,"select",this.onSelect)},onSelect:function(a){this.$el.toggle(a===this.model)}});b.exports=d},{"./empty-section":64}],67:[function(a,b,c){var d=Marionette.CollectionView.extend({childView:a("./section"),emptyView:a("./empty-modal"),childViewOptions:function(a,b){return{model:a,element:this.element,collection:this.controls}},initialize:function(a){this.element=a.element,this.controls=a.controls}});b.exports=d},{"./empty-modal":63,"./section":66}],68:[function(a,b,c){var d=Marionette.ItemView.extend({tagName:"li",className:"tab",attributes:{tabindex:0},events:{click:"select",keypress:"onKeyPress"},template:"#tmpl-tailor-modal-item",select:function(){this.triggerMethod("select")},onSelect:function(){this.model.trigger("select",this.model),this.el.focus()},onKeyPress:function(a){13===a.which&&this.select()}});b.exports=d},{}],69:[function(a,b,c){var e,d=a("./tab");e=Marionette.CollectionView.extend({tagName:"ul",className:"tabs",childView:d,childEvents:{select:"onSelect"},onRender:function(){this.collection.length>0&&this.children.first().triggerMethod("select")},onSelect:function(a){this.children.each(function(b){b.$el.toggleClass("is-active",a===b)})}}),b.exports=e},{"./tab":68}],70:[function(a,b,c){var e,d=window.Tailor.Notify;e=Marionette.Module.extend({onStart:function(){this.addEventListeners(),app.channel.trigger("module:notifications:ready",this)},addEventListeners:function(){var a=window._l10n;this.listenTo(app.channel,"sidebar:save",function(){d(a.savedPage,"success")}),this.listenTo(app.channel,"elements:restore",function(){d(a.restoreElements,"success")}),this.listenTo(app.channel,"element:delete",function(){d(a.deletedElement,"success")}),this.listenTo(app.channel,"template:save",function(){d(a.savedTemplate,"success")}),this.listenTo(app.channel,"template:import",function(){d(a.importedTemplate,"success")}),this.listenTo(app.channel,"template:add",function(){d(a.addedTemplate,"success")}),this.listenTo(app.channel,"template:delete",function(){d(a.deletedTemplate,"success")})}}),b.exports=e},{}],71:[function(a,b,c){var g,d=a("../../entities/collections/panels"),e=a("./show/layout"),f=a("./show/panel-menu-item");Tailor.Items.Panels=f,g=Marionette.Module.extend({onBeforeStart:function(a){var b=this;b.collection=new d(a.panels);var c={getPanels:function(a){return a?b.collection.findWhere({id:a}):b.collection}};app.channel.reply("sidebar:panels",c.getPanels)},onStart:function(){app.content.show(new e({panels:app.channel.request("sidebar:panels"),sections:app.channel.request("sidebar:sections"),controls:app.channel.request("sidebar:controls"),settings:app.channel.request("sidebar:settings")})),app.channel.trigger("module:panels:ready",this)}}),b.exports=g},{"../../entities/collections/panels":40,"./show/layout":72,"./show/panel-menu-item":73}],72:[function(a,b,c){var e,d=a("./panels");e=Marionette.LayoutView.extend({ui:{pageTitle:".back-button"},className:"tailor-sidebar__layout",regions:{panels:"#tailor-sidebar-home",panel:"#tailor-sidebar-panel",section:"#tailor-sidebar-section"},childEvents:{"show:panel":"showPanel","show:section":"showSection","back:home":"displayHome","back:panel":"displayPanel"},template:function(){return document.getElementById("tmpl-tailor-sidebar-layout").innerHTML},initialize:function(a){this.panels=a.panels,this.sections=a.sections,this.controls=a.controls,this.settings=a.settings},onRender:function(){this.showChildView("panels",new d({collection:this.panels}))},showPanel:function(a){this.displayPanel();var b=app.channel.request("sidebar:"+a.model.get("type")),c=Tailor.lookup(a.model.get("type"),!1,"Panels");this.showChildView("panel",new c({model:a.model,collection:b}))},showSection:function(a){this.el.classList.add("section-visible"),this.el.classList.remove("panel-visible");var b=Tailor.lookup(a.model.get("type"),!1,"Sections");this.showChildView("section",new b({model:a.model,collection:this.controls,panel:this.panels.findWhere({id:a.model.get("panel")})}))},displayHome:function(a){this.el.classList.remove("panel-visible"),this.el.classList.remove("section-visible"),a&&a.model.trigger("focus")},displayPanel:function(a){this.el.classList.remove("section-visible"),this.el.classList.add("panel-visible"),a&&a.model.trigger("focus")}}),b.exports=e},{"./panels":75}],73:[function(a,b,c){var e,d=Backbone.$;e=Marionette.ItemView.extend({events:{click:"onClick",keypress:"onKeyPress"},modelEvents:{focus:"onFocus"},template:"#tmpl-tailor-panel-default-item",attachElContent:function(a){var b=d(a);return this.$el.replaceWith(b),this.setElement(b),this.el.setAttribute("tabindex",0),this},onClick:function(){this.triggerMethod("show:panel")},onKeyPress:function(a){13===a.which&&this.triggerMethod("show:panel")},onFocus:function(){this.el.focus()}}),b.exports=e},{}],74:[function(a,b,c){var d=Marionette.ItemView.extend({className:"empty",template:"#tmpl-tailor-home-empty"});b.exports=d},{}],75:[function(a,b,c){var d=Marionette.CompositeView.extend({getChildView:function(){return Tailor.lookup("panels",!1,"Items")},childViewContainer:"#items",emptyView:a("./panels-empty"),behaviors:{Panel:{}},template:"#tmpl-tailor-home"});b.exports=d},{"./panels-empty":74}],76:[function(a,b,c){var f,d=a("../../entities/collections/sections"),e=a("./show/default-menu-item");Tailor.Items.Default=e,f=Marionette.Module.extend({onBeforeStart:function(a){var b=this;b.collection={sidebar:new d(a.sections)};var c={getSections:function(a){if(!a)return b.collection.sidebar;var c=a.cid;if(!b.collection.hasOwnProperty(c)){var e=app.channel.request("sidebar:library",a.get("tag")),f=e.get("sections")||[];b.collection[c]=new d(f)}return b.collection[c]}};app.channel.reply("sidebar:sections sidebar:default",c.getSections)},onStart:function(){app.channel.trigger("module:sections:ready",this)}}),b.exports=f},{"../../entities/collections/sections":42,"./show/default-menu-item":77}],77:[function(a,b,c){var e,d=Backbone.$;e=Marionette.ItemView.extend({events:{click:"onClick",keypress:"onKeyPress"},modelEvents:{focus:"onFocus"},template:"#tmpl-tailor-panel-default-item",attachElContent:function(a){var b=d(a);return this.$el.replaceWith(b),this.setElement(b),this.el.setAttribute("tabindex",0),this},onClick:function(){this.triggerMethod("show:section")},onKeyPress:function(a){13===a.which&&this.triggerMethod("show:section")},onFocus:function(){this.el.focus()}}),b.exports=e},{}],78:[function(a,b,c){var f,d=a("../../entities/collections/settings"),e=a("../../entities/collections/controls");f=Marionette.Module.extend({onBeforeStart:function(a){var b=this;b.settings={sidebar:new d(a.settings)},b.controls={sidebar:new e(a.controls,{silent:!1,settings:b.settings.sidebar})};var c={getControls:function(a){if(!a)return b.controls.sidebar;var d=a.cid;if(!b.controls.hasOwnProperty(d)){var f=app.channel.request("sidebar:library",a.get("tag")),g=f.get("controls")||[],h=c.getSettings(a);b.controls[d]=new e(g,{silent:!1,settings:h})}return b.controls[d]},getSettings:function(a){if(!a)return b.settings.sidebar;var c=a.cid;if(!b.settings.hasOwnProperty(c)){var e=app.channel.request("sidebar:library",a.get("tag")),f=e.get("settings")||[];b.settings[c]=new d(f,{element:a})}return b.settings[c].load(),b.settings[c]}};app.channel.reply("sidebar:controls",c.getControls),app.channel.reply("sidebar:settings",c.getSettings),this.listenTo(b.settings.sidebar,"change",this.onChangeSetting)},onStart:function(){app.channel.trigger("module:settings:ready",this)},onChangeSetting:function(a){app.channel.trigger("sidebar:setting:change",a)}}),b.exports=f},{"../../entities/collections/controls":38,"../../entities/collections/settings":43}],79:[function(a,b,c){var f,d=Backbone.$,e=window._l10n;f=Marionette.ItemView.extend({ui:{delete:".js-delete-template",download:".js-download-template",preview:".js-preview-template"},events:{click:"onClick"},modelEvents:{"change:match":"onSearch"},behaviors:{Draggable:{}},onClick:function(a){switch(a.target){case this.ui.download.get(0):this.download();break;case this.ui.delete.get(0):this.delete();break;case this.ui.preview.get(0):this.preview();break;default:var b=this.el,c=function(a){b.removeEventListener(window.animationEndName,c),b.classList.remove("shake")};Modernizr.cssanimations&&(b.addEventListener(window.animationEndName,c),b.classList.add("shake")),Tailor.Notify(e.dragTemplate,"warning")}},getTemplate:function(){return"#tmpl-tailor-panel-templates-item"},attachElContent:function(a){var b=d(a);return this.$el.replaceWith(b),this.setElement(b),this.el.setAttribute("tabindex",0),this},download:function(){var a=this,b=a.model.get("id");window.ajax.send("tailor_load_template",{data:{template_id:b,nonce:window._nonces.loadTemplate},success:function(c){var d=a.model,e=c.models,f=d.get("label");b=f.replace(" ","-").toLowerCase();var g={id:b,label:f,tag:d.get("tag"),type:d.get("type"),models:e};g="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(g));var h=document.getElementById("download-template");h.setAttribute("href",g),h.setAttribute("download","tailor-template-"+b+"-"+Date.now()+".json"),h.click(),app.channel.trigger("template:download")}})},delete:function(){var a=this;window.ajax.send("tailor_delete_template",{data:{id:a.model.get("id"),nonce:window._nonces.deleteTemplate},success:function(){a.$el.slideUp(function(){a.model.trigger("destroy",a.model)}),app.channel.trigger("template:delete")}})},preview:function(){window.open(window._urls.view+"?template_preview=1&template_id="+this.model.get("id"),"_blank"),app.channel.trigger("template:preview")},onSearch:function(a){this.el.style.display=a.get("match")?"block":"none"}}),b.exports=f},{}],80:[function(a,b,c){var e,d=window._l10n;e=Marionette.CompositeView.extend({ui:{backButton:".back-button",save:".js-save-template",import:".js-import-template",searchForm:".search-form"},events:{"click @ui.save":"save","click @ui.import":"import"},triggers:{"click @ui.backButton":"back:home"},behaviors:{Panel:{}},emptyView:Tailor.Panels.Empty,emptyViewOptions:function(){return{type:this.model.get("type")}},template:"#tmpl-tailor-panel-templates",childViewContainer:"#items",getChildView:function(){return Tailor.lookup(this.model.get("type"),!1,"Items")},serializeData:function(){var a=Marionette.ItemView.prototype.serializeData.apply(this,arguments);return a.items=this.collection,a},onShow:function(){this.ui.backButton.get(0).focus(),0===this.collection.length&&this.ui.searchForm.hide()},onAddChild:function(){this.ui.searchForm.show()},onRemoveChild:function(){0===this.collection.length&&this.ui.searchForm.hide()},import:function(a){var b=this,c={title:d.importTemplate,content:document.querySelector("#tmpl-tailor-dialog-import-template").innerHTML,button:d.import,onOpen:function(){this.el.querySelector("#import-template").focus()},onValidate:function(){var a=this.el.querySelector("#import-template"),b=/(?:\.([^.]+))?$/;return a.value&&"json"===b.exec(a.value)[1]},onSave:function(){var a=this.el.querySelector("#import-template"),c=a.files[0];if(!c||c.name.match(/.+\.json/)){var d=new FileReader;d.onload=function(a){var c={label:"",tag:"",models:[],nonce:window._nonces.saveTemplate},e=_.extend(c,JSON.parse(d.result));e.models=JSON.stringify(e.models),b.createTemplate(e,"import")};try{d.readAsText(c)}catch(a){}}},onClose:function(){b.ui.import.focus()}};app.channel.trigger("dialog:open",c)},save:function(){var e,a=app.channel.request("canvas:element:selected"),b=app.channel.request("canvas:elements"),c=[];if(a&&"function"==typeof a.get){var f=function(a){_.each(b.where({parent:a}),function(a){c.push(a.toJSON()),f(a.get("id"))})};"child"==a.get("type")&&(a=a.collection.get(a.get("parent"))),f(a.get("id")),a=a.toJSON(),a.parent="",c.push(a),e=a.tag}else c=b.models,e="tailor_section";var g=this;app.channel.trigger("dialog:open",{title:d.saveTemplate,content:document.querySelector("#tmpl-tailor-dialog-save-template").innerHTML,button:d.save,onOpen:function(){this.el.querySelector("#save-template").focus()},onValidate:function(){var a=this.el.querySelector("#save-template");return a.value.trim()},onSave:function(){var a=this.el.querySelector("#save-template"),b={label:a.value,tag:e,models:JSON.stringify(c),nonce:window._nonces.saveTemplate};g.createTemplate(b,"save")},onClose:function(){g.ui.save.focus()}})},createTemplate:function(a,b){b=b||"save";var c=this,d=c.collection;c.ui.save.prop("disabled",!0),c.ui.import.prop("disabled",!0),window.ajax.send("tailor_save_template",{data:a,success:function(a){d.add({id:a.id,label:a.label,tag:a.tag,type:a.type}),app.channel.trigger("template:"+b)},complete:function(){c.ui.save.prop("disabled",!1),c.ui.import.prop("disabled",!1)}})}}),b.exports=e},{}],81:[function(a,b,c){var g,d=a("../../entities/collections/templates"),e=a("./show/templates-panel"),f=a("./show/template-menu-item");Tailor.Panels.Templates=e,Tailor.Items.Templates=f,g=Marionette.Module.extend({onBeforeStart:function(a){var b=this;this.collection=new d(a.templates);var c={getTemplates:function(){return b.collection}};app.channel.reply("sidebar:templates",c.getTemplates)},onStart:function(){app.channel.trigger("module:templates:ready",this)}}),b.exports=g},{"../../entities/collections/templates":45,"./show/template-menu-item":79,"./show/templates-panel":80}],82:[function(a,b,c){var d=jQuery,e=document.querySelector(".tailor__home .title");Tailor.Api.Setting.onChange("sidebar:_post_title",function(a,b){if(e.hasChildNodes())for(var c=e.childNodes,d=1;d<c.length;d++)3==c[d].nodeType&&-1!==c[d].nodeValue.indexOf(b)&&(c[d].nodeValue=a);document.title=window._l10n.tailoring+a});var f=d(".devices button"),g=document.querySelector(".tailor-preview"),h=document.querySelector(".tailor-preview__viewport"),i=window._media_queries;f.on("click",function(a){var b=a.target;f.each(function(){if(this==b){var a=b.getAttribute("data-device");this.classList.add("is-active"),this.setAttribute("aria-pressed","true"),g.className="tailor-preview "+a+"-screens",i.hasOwnProperty(a)&&i[a].max?h.style.maxWidth=i[a].max:h.style.maxWidth=""}else this.classList.remove("is-active"),this.setAttribute("aria-pressed","false")})}).first().click()},{}],83:[function(a,b,c){!function(b,c){"use strict";function g(a){return a=a||"",a.replace(/_|-|tailor_/gi," ").replace(/(?: |\b)(\w)/g,function(a){return a.toUpperCase().replace(/\s+/g,"")})}var d=c(document),e=c(b);a("../shared/utility/polyfills/classlist"),a("../shared/utility/polyfills/raf"),a("../shared/utility/polyfills/transitions"),a("../shared/utility/ajax"),Marionette.Behaviors.behaviorsLookup=function(){return{Resizable:a("./components/behaviors/resizable"),Panel:a("./components/behaviors/panel"),Draggable:a("../shared/components/behaviors/draggable")}};var f=a("./app");b.app=new f,b.Tailor={Api:{Setting:a("../shared/components/api/setting")},Notify:a("../shared/utility/notify"),Models:{},Panels:{},Sections:{},Controls:{},Items:{},Helpers:{checkCondition:function(a,b,c){switch(a){case"equals":return b===c;case"not":return _.isArray(c)?-1===c.indexOf(b):b!==c;case"lessThan":return b<parseInt(c,10);case"greaterThan":return b>parseInt(c,10);case"contains":if(_.isString(b)&&(b=b.split(",")),_.isArray(c)){var d=_.intersection(c,b);return 0!==d.length}return-1!==_.indexOf(b,c)}}}},wp.media.view.settings.post.id=b.post.id,app.addRegions({content:"#tailor-sidebar-content",dialog:{selector:"#tailor-dialog-container",regionClass:a("./modules/dialog/dialog-region")},modal:{selector:"#tailor-modal-container",regionClass:a("./modules/modal/modal-region")}}),Tailor.Models.Container=a("./entities/models/element-container"),Tailor.Models.Wrapper=a("./entities/models/element-wrapper"),Tailor.Models.Section=a("./entities/models/element-wrapper"),Tailor.Models.Default=a("./entities/models/element"),Tailor.Panels.Default=a("./components/panels/panel-default"),Tailor.Panels.Empty=a("./components/panels/panel-empty"),Tailor.Sections.Default=a("./components/sections/section-default"),Tailor.Controls.ButtonGroup=a("./components/controls/button-group"),Tailor.Controls.Checkbox=a("./components/controls/checkbox"),Tailor.Controls.Code=a("./components/controls/code"),Tailor.Controls.Colorpicker=a("./components/controls/colorpicker"),Tailor.Controls.Editor=a("./components/controls/editor"),Tailor.Controls.Gallery=a("./components/controls/gallery"),Tailor.Controls.Icon=a("./components/controls/icon"),Tailor.Controls.Image=a("./components/controls/image"),Tailor.Controls.Link=a("./components/controls/link"),Tailor.Controls.List=a("./components/controls/list"),Tailor.Controls.Radio=a("./components/controls/radio"),Tailor.Controls.Range=a("./components/controls/range"),Tailor.Controls.Select=a("./components/controls/select"),Tailor.Controls.SelectMulti=a("./components/controls/select-multi"),Tailor.Controls.Style=a("./components/controls/style"),Tailor.Controls.Switch=a("./components/controls/switch"),Tailor.Controls.Text=a("./components/controls/text"),Tailor.Controls.Textarea=a("./components/controls/textarea"),Tailor.Controls.Video=a("./components/controls/video"),Tailor.Controls.WidgetForm=a("./components/controls/widget-form"),Tailor.Controls.Default=a("./components/controls/text"),Tailor.lookup=function(a,b,c){if(!Tailor.hasOwnProperty(c))return void console.error("Object type "+c+" does not exist");var d=g(a);return Tailor[c].hasOwnProperty(d)?Tailor[c][d]:b&&(d=g(b),Tailor[c].hasOwnProperty(d))?Tailor[c][d]:Tailor[c].Default},app.on("start",function(c){app.module("module:library",a("./modules/library/library")),app.module("module:templates",a("./modules/templates/templates")),app.module("module:settings",a("./modules/settings/settings")),app.module("module:history",a("./modules/history/history")),app.module("module:sections",a("./modules/sections/sections")),app.module("module:panels",a("./modules/panels/panels")),app.module("module:modal",a("./modules/modal/modal")),app.module("module:dialog",a("./modules/dialog/dialog")),app.module("module:notification",a("./modules/notifications/notifications")),a("./preview"),d.on("heartbeat-send",function(a,c){c.tailor_post_id=b.post.id}),wp.heartbeat.interval(60),wp.heartbeat.connectNow(),e.on("beforeunload.tailor",function(a){if(app.hasUnsavedChanges())return b._l10n.confirmPage}).on("unload.tailor",function(a){b.ajax.send("tailor_unlock_post",{data:{post_id:c.postId,nonce:c.nonces.unlockPost}})})}),d.ready(function(){app.start({postId:b.post.id,nonces:b._nonces,l10n:b._l10n||[],library:b._library||[],templates:b._templates||[],panels:b._panels||[],sections:b._sections||[],settings:b._settings||[],controls:b._controls||[]}),app.channel.trigger("sidebar:initialize",app)})}(window,Backbone.$)},{"../shared/components/api/setting":1,"../shared/components/behaviors/draggable":2,"../shared/utility/ajax":3,"../shared/utility/notify":4,"../shared/utility/polyfills/classlist":5,"../shared/utility/polyfills/raf":6,"../shared/utility/polyfills/transitions":7,"./app":8,"./components/behaviors/panel":9,"./components/behaviors/resizable":10,"./components/controls/button-group":12,"./components/controls/checkbox":13,"./components/controls/code":14,"./components/controls/colorpicker":15,"./components/controls/editor":16,"./components/controls/gallery":17,"./components/controls/icon":18,"./components/controls/image":19,"./components/controls/link":20,"./components/controls/list":23,"./components/controls/radio":24,"./components/controls/range":25,"./components/controls/select":27,"./components/controls/select-multi":26,"./components/controls/style":28,"./components/controls/switch":29,"./components/controls/text":30,"./components/controls/textarea":31,"./components/controls/video":32,"./components/controls/widget-form":33,"./components/panels/panel-default":34,"./components/panels/panel-empty":35,"./components/sections/section-default":36,"./entities/models/element":49,"./entities/models/element-container":47,"./entities/models/element-wrapper":48,"./modules/dialog/dialog":55,"./modules/dialog/dialog-region":54,"./modules/history/history":57,"./modules/library/library":59,"./modules/modal/modal":62,"./modules/modal/modal-region":61,"./modules/notifications/notifications":70,"./modules/panels/panels":71,"./modules/sections/sections":76,"./modules/settings/settings":78,"./modules/templates/templates":81,"./preview":82}]},{},[83]);